const familyData = {
    name: "Dakumi",spouse:"Kartijan",
    children: [
        {
            name: "Suryami",
            spouse: "Carsiyan",
            children: [
                {
                    name: "Sa'ad",
                    spouse: "Suyem",
                    children: [
                        { name: "Wartoyo", spouse: "Orang China", children: [] },
                        { name: "Mundriyah", spouse: "Orang Palembang", children: [] },
                        { name: "Kasmudi", spouse: "Turah", children: [] },
                        { name: "Duriyah (Sidur)", spouse: "Orang Sumatera", children: [] },
                        {
                            name: "Yuti",
                            spouse: "Yasin",
                            children: [
                                { name: "Fani Setiawan" },
                                { name: "Faris" }
                            ]
                        }
                    ]
                },
                {
                    name: "Waryu",
                    spouse: "Supari",
                    children: [
                        { name: "Kartoyo", spouse: "Darsini", children: [] },
                        { name: "Yudi", spouse: "Orang Bumirejo", children: [] },
                        { name: "Katrun", spouse: "Orang Sembung", children: [] },
                        { name: "Siwu (Wunipah)", spouse: "Sitol", children: [] },
                        { name: "Taryi", spouse: "tidak diketahui", children: [] }
                    ]
                },
                {
                    name: "Sibeng",
                    spouse: "Wardan",
                    children: [
                        { name: "Sri", spouse: "Ranya'", children: [{ name: "Eli" }, { name: "Tuginem" }] },
                        { name: "Sun", spouse: "Tayain", children: [{ name: "Riyanto" }, { name: "Rohati" }, { name: "Sigit" }] },
                        { name: "Wagi", spouse: "Dirjo", children: [{ name: "laki 1" }, { name: "cewe 1" }] },
                    ]
                },
                {
                    name: "Tabyan",
                    spouse: "Saruni",
                    children: [
                        { name: "Rumyati", spouse: "Bejo", children: [] },
                        { name: "Duri", spouse: "Mustofiya", children: [] },
                        { name: "Kunari", spouse: "Tosirin", children: [] },
                        { name: "Kartono", spouse: "Orang pagergunung", children: [] },
                        { name: "Sikris(Krisyanto)", spouse: "(Putune Kastolani)", children: [] },
                        { name: "Ningsih", spouse: "(gatau simbahe)", children: [] },
                    ]
                },
                {
                    name: "Taiyah",
                    spouse: "Casyono",
                    children: [
                        { name: "Di blendung gatau" }
                    ]
                },
            ]
        },
        {
            name: "Ndari",
            spouse: "Kendho (Sutoyo)",
            children: [
                {
                    name: "Mukri",
                    spouse: "Rahayu",
                    children: [
                        { name: "Belum diketahui (5 anak)" }
                    ]
                },
                {
                    name: "Casmiah",
                    spouse: "Kusen",
                    children: [{ name: "Gapunya anak" }]
                },
                {
                    name: "Suryan",
                    spouse: "Muryati",
                    children: [
                        { name: "Heri Mugiono", spouse: "Turip (anake h.Asroh)", children: [] },
                        { name: "Yitno", spouse: "Turiyah", children: [] },
                        { name: "Heni", spouse: "(orang Sragi)", children: [] },
                        { name: "Gathot Sumanto", spouse: "(anake Mus Sembung)", children: [] },
                        { name: "Sugeng", spouse: "Tidak diketahui (orang jauh)", children: [] },
                    ]
                },
                {
                    name: "Rasiwen",
                    spouse: "Radan",
                    children: [
                        { name: "Janji", spouse: "(pernah sama sinok)", children: [] },
                        { name: "Tarman", spouse: "(orang ulujami)", children: [] },
                        { name: "Sikun", spouse: "(orang Tuban)", children: [] },
                        { name: "Wadiyo", spouse: "(Tidak diketahui)", children: [] },
                        { name: "Badi", spouse: "Tidak diketahui (anaknya polisi Suratman)", children: [] },
                    ]
                },
                {
                    name: "Comong(Perawan Mati)",
                    spouse: null,
                    children: []
                },
            ]
        },
        {
            name: "Siru",
            spouse: "Narsid",
            children: [
                {
                    name: "Sahuri",
                    spouse: "Ilin",
                    children: [
                        { name: "Isworo", spouse: "Bu Parni", children: [{ name: "Liya" }, { name: "Tri" }] },
                        { name: "Tuti", spouse: "Suwarno", children: [{ name: "belum diketahui" }] },
                        { name: "Julaiha", spouse: "(Orang Cipete jakarta)", children: [{ name: "belum diketahui" }] },
                        { name: "Rejeh Biyatun", spouse: "(orang cipete juga)", children: [{ name: "belum diketahui" }] },
                    ]
                },
                {
                    name: "Rasidah",
                    spouse: "Sinang",
                    children: []
                },
                {
                    name: "Casmirah",
                    spouse: "Sumarto",
                    children: []
                },
                {
                    name: "Kembur(Waryadi)",
                    spouse: "Siru",
                    children: [{ name: "Gapunya anak" }]
                },
            ]
        },
        {
            name: "Redi Rahayu",
            spouse: "Yasir",
            children: [
                {
                    name: "Casiun",
                    spouse: "Asari",
                    children: []
                },
                {
                    name: "Sunaryo",
                    spouse: "Indun",
                    children: []
                },
                {
                    name: "Saryu",
                    spouse: "Suhari",
                    children: [
                        { name: "Sismanto", spouse: "Manisah", children: [{ name: "Huda" }, { name: "Agus" }, { name: "Sakti" }, { name: "Bunga" }] },
                        { name: "Kusriyati", spouse: "Waryun", children: [{ name: "Sandi" }, { name: "Fahmi" }] },
                        { name: "Winarni", spouse: "Eko", children: [{ name: "Aliyah" }, { name: "M. Davi" }] },
                        { name: "Heni", spouse: "Karyanto", children: [{ name: "Bima" }, { name: "Dini" }, { name: "Noval" }] },
                        { name: "Nuryanto", spouse: "(Di Jakarta)", children: [] },
                    ]
                },
                {
                    name: "Sayumi",
                    spouse: "Amat Nuryan",
                    children: [
                        { name: "Rozikin", spouse: "Khusnul Khotimah", children: [{ name: "Afta Aulia Mifda" }, { name: "Aqila Azza Lia" }, { name: "Alfaj dinul haq" }] },
                        { name: "Sihu", spouse: "Hamidah", children: [{ name: "Firman" }, { name: "Gilang" }, { name: "Baihaqi" }] },
                        { name: "Nur Iman", spouse: "Eka", children: [{ name: "Kia" }, { name: "Hafidz" }, { name: "Kanaya" }] },
                        { name: "Sujai", spouse: "Otin Nuraeni", children: [{ name: "Alisha Khoiro Wilda" }, { name: "Akifah Husna Ramadhani" }, { name: "Anindya Shaidah Putri" }] },
                        {
                            name: "Munasiah",
                            spouse: "Irwansyah",
                            children: [
                                { name: "Arsyila" }] },
              
                {
                    name: "Mustofiyah",
                    spouse: "Waluyo",
                    children: [{ name: "Mahira Salma" }, { name: "Andin Cahaya Amira" }]
                },
                        ]},
                {
                    name: "Sayi",
                    spouse: "Nursaid",
                    children: [
                        { name: "Tosirin", spouse: "Kunari", children: [{ name: "Alda Alifa" }] },
                        { name: "Wigiarti", spouse: "Warno", children: [] },
                        { name: "Junaedi", spouse: "Bojone 2 variabel", children: [] },
                        { name: "Rustiyo", spouse: "Thoriq", children: [{ name: "Aldi" }] },
                        { name: "Winarsih", spouse: "(Jihad)", children: [{ name: "Jihan" }] },
                    ]
                },
            ]
        }
    ]
};
// Fungsi membuat pohon keluarga
   // Tetap gunakan event listener pada tombol dengan ID searchButton
document.getElementById('searchButton').addEventListener('click', searchFamily);

function createFamilyTree(data, container, generation = 0) {
    const node = document.createElement('div');
    node.className = `node generation-${generation % 5}`;
    node.textContent = data.name;

    if (data.spouse) {
        const spouse = document.createElement('div');
        spouse.className = 'spouse';
        spouse.textContent = `Pasangan: ${data.spouse}`;
        node.appendChild(spouse);
    }

    node.onclick = () => {
        const children = node.nextElementSibling;
        if (children) {
            children.style.display = children.style.display === 'block' ? 'none' : 'block';
        }
    };

    container.appendChild(node);

    if (data.children && data.children.length > 0) {
        const childrenContainer = document.createElement('div');
        childrenContainer.className = 'children';
        container.appendChild(childrenContainer);

        data.children.forEach(child => createFamilyTree(child, childrenContainer, generation + 1));
    }
}

function renderFamilyTree() {
    const container = document.getElementById('familyTree');
    container.innerHTML = '';
    createFamilyTree(familyData, container);
}

function searchFamily() {
    const searchValue = document.getElementById('searchBar').value.toLowerCase().trim();
    if (!searchValue) {
        alert('Masukkan nama atau pasangan untuk pencarian!');
        return;
    }

    const result = findFamilyMember(familyData, searchValue);
    const container = document.getElementById('familyTree');
    container.innerHTML = '';

    if (result) {
        createFamilyTree(result, container);
    } else {
        alert('Nama atau pasangan tidak ditemukan!');
        renderFamilyTree();
    }
}

function findFamilyMember(data, name) {
    if (
        data.name.toLowerCase().includes(name) ||
        (data.spouse && data.spouse.toLowerCase().includes(name))
    ) {
        return data;
    }

    if (data.children && data.children.length > 0) {
        for (const child of data.children) {
            const found = findFamilyMember(child, name);
            if (found) return found;
        }
    }

    return null;
}

// Inisialisasi pohon keluarga
renderFamilyTree();
